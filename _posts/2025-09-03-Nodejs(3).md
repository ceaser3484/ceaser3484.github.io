---
defaults:
  # _posts
  - scope:
      path: ""
      type: posts
    values:
      layout: single
      author_profile: true
      read_time: true
      comments: true
      share: true
      related: true
    author: Ceaser
---

# NodeJs 정리 : 모듈화 - 파일 쪼개기
## 모듈화
- 현실적으로 한 js 파일에 많은 html을 관리한다는 것은 불가능
- 웹 서비스에서 많은 기능을 한 파일에 담기에는 불가능
- 다른 파일에 각각 담고, 한 파일만 수정하면 되는 유지, 보수가 간편해 지는 장점이 있다. 

### express 설치
- 내 프로젝트에 해당하는 폴더에서 다음의 명령어로 express 설치
```cmd
npm install express
```
그러면 node_module(맞나?) 폴더가 만들어지고, 거기에 express 패키지가 설치되는 것을 확인할 수 있음.

### server 본진(?)
```
MyExpress01
 ┣ router
 ┃ ┣ about.js
 ┃ ┗ user.js
 ┣ Ex03.html
 ┣ Ex05.html
 ┣ package-lock.json
 ┣ package.json
 ┗ server.js
 ```
 - router 폴더는 따로 떼어낸 모듈
 - server.js를 실행하여서 모든 것들을 실행하는 구조

#### server.js
```javascript
const express = require("express");
// app : 서버정보를 전부 지니고 있는 변수
const app = express();

// post 방식으로 데이터 통신시에 body 영역윽 사용할 수 있게끔 허용하겠습니다. 
app.use(express.urlencoded({extended: true}));
app.use(express.json());

// http://localhost:3000/ 으로 get 방식을 통해 요청이 들어온다면 
// 콜백함수를 통해 요청에 따른 응답을 처리하겠습니다!
app.get("/", (request, response)=>{
    console.log("express 접근 확인");
})



const user = require("./router/user");
const calculator = require("./router/about");

// 모듈에 절대 경로 부여
app.use("/user",user);
app.use("/about", calculator);


app.listen(3000); // 3000번 포트에서 듣고 있겠음!

```
- require로 express 가져옴.
- post 방식으로 썼기 때문에 post로 보내온 값들을 오브젝트로 받을 수 있게 아래의 코드 삽입
```javascript
app.use(express.urlencoded({extended: true}));
app.use(express.json());
```
- router로 코드를 분리하였다 하더라도 웹상에서는 헛깔리기 쉽기에 모듈에 절대경로 붙임
  - ```app.use("/user",user);
      app.use("/about", calculator);``` 에 설정하였으므로...
  - 예를 들어서 http://localhost:3000/user/login 이런 식으로 form 태그에서 action의 주소를 주어야 함

### 모듈 : router/user.js
```javascript
const express = require("express");
const router = express.Router();
// router : 서버에 적용되는 모듈화 변수. 

router.post("/login", (request, response)=>{
    // request로부터 ID와 PW꺼내 사용
    console.log(request.body);
    let inputId = request.body.ID;
    let inputPw = request.body.PW;
    
    if (inputId == "smhrd" && inputPw == '123'){
        response.write("login success");
    }
    else{
        response.write("login failed");
    }
    response.end();
})

module.exports = router;
```
- 맨 위에 express를 불러오고는 그 아래의 Router를 불러온다. 
- 그럼 router로 url에서 데이터를 받아 처리하는 코드(원래 서버에 있던 것)
- 그러면 이걸 원래의 server.js에서 받는 방법은 
```javascript
module.exports = router;
```
으로 원래의 서버에 받는다. 